@model Web.Models.ViewModel.TablePageModel
<h2>@Model.Title</h2>
<h4>@Model.SubTitle</h4>
<hr />


@using (Html.BeginForm(ViewContext.RouteData.Values["action"] as string, ViewContext.RouteData.Values["controller"] as string, FormMethod.Get))
{
    var columns = Model.GetColumns().ToList();
    
    //Поиск по всем
    if (Model.GlobalSearch)
    {
        <div class="col-md-offset-9">
            @Html.EditorFor(n => n.QueryObject.Search, new { placeholder = "Search", @class = "submitonenter" })
        </div>
    }

    <table class="table">
        <thead>
            @*Фильтр по колонкам*@
            @if (columns.Any(n => n.IsFiltered))
            {
                <tr>
                    @for (var i = 0; i < columns.Count; i++)
                    {
                        <th>
                            @Html.HiddenFor(n => n.QueryObject.SearchCoditionals[i].Key, new { @Value = columns[i].Key })
                            @if (columns[i].IsFiltered)
                            {
                                @Html.EditorFor(n => n.QueryObject.SearchCoditionals[i].Value, new { placeholder = columns[i].Title, @class = "submitonenter" })
                            }
                        </th>
                    }
                </tr>
            }

            @*Заголовки колонок*@
            <tr>
                @foreach (var column in columns)
                {
                    <th>@column.Title</th>
                }
            </tr>
        </thead>
        @*Пейджинг*@
        @if (Model.GetPaing().TotalPages > 1)
        {
            <tfoot>
                <tr>
                    <td colspan="@(columns.Count())">
                        @Html.DisplayFor(model => model, "Paging")
                    </td>
                </tr>
            </tfoot>
        }

        @*Записи*@
        <tbody>
            @if (!Model.GetItems().Any())
            {
                <tr>
                    <td colspan="@(columns.Count())">
                        no result
                    </td>
                </tr>
            }
            else
            {
                foreach (var item in Model.GetItems())
                {
                    <tr>
                        @Html.DisplayFor(n => item, "TableRow")
                    </tr>
                }
            }
        </tbody>
    </table>
}
